/**
 * 천간론(天干論) — 십천간(十天干)의 성질과 특성
 *
 * 甲乙丙丁戊己庚辛壬癸
 *
 * 이론 근거: 자평진전(子平眞詮), 적천수(滴天髓), 연해자평(淵海子平)
 *
 * 인덱스 배속:
 *   0=甲(GAP)  1=乙(EUL)  2=丙(BYEONG)  3=丁(JEONG)  4=戊(MU)
 *   5=己(GI)   6=庚(GYEONG) 7=辛(SIN)   8=壬(IM)     9=癸(GYE)
 *
 * 오행 배속:
 *   MOK(木)=甲乙  HWA(火)=丙丁  TO(土)=戊己  GEUM(金)=庚辛  SU(水)=壬癸
 */

import type { StemIdx } from '../core/cycle.js';

// ─────────────────────────────────────────────────────────────────────────────
// 타입 정의
// ─────────────────────────────────────────────────────────────────────────────

/** 천간 로마자 식별자 (갑→계 순서) */
export type StemName =
  | 'GAP'    // 甲 0
  | 'EUL'    // 乙 1
  | 'BYEONG' // 丙 2
  | 'JEONG'  // 丁 3
  | 'MU'     // 戊 4
  | 'GI'     // 己 5
  | 'GYEONG' // 庚 6
  | 'SIN'    // 辛 7
  | 'IM'     // 壬 8
  | 'GYE';   // 癸 9

// ─────────────────────────────────────────────────────────────────────────────
// 인덱스 ↔ 이름 매핑 테이블
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 천간 이름 배열 — 인덱스(0~9) 순서와 일치.
 * `STEM_NAMES[idx]` → `StemName`
 */
export const STEM_NAMES: readonly StemName[] = [
  'GAP', 'EUL', 'BYEONG', 'JEONG', 'MU',
  'GI', 'GYEONG', 'SIN', 'IM', 'GYE',
] as const;

/**
 * 천간 이름 목록 (갑→계 순서).
 * `STEM_NAMES`와 동일 참조이며 가독성을 위한 별칭으로 제공.
 */
export const STEM_NAME_LIST: readonly StemName[] = STEM_NAMES;

/**
 * 천간 이름 → 인덱스(StemIdx) 역변환 맵.
 * 예: `STEM_NAME_TO_IDX['GAP'] === 0`
 */
export const STEM_NAME_TO_IDX: Record<StemName, StemIdx> = {
  GAP: 0, EUL: 1, BYEONG: 2, JEONG: 3, MU: 4,
  GI: 5, GYEONG: 6, SIN: 7, IM: 8, GYE: 9,
} as const;

/**
 * 천간 인덱스(StemIdx) → 이름 역변환 맵.
 * 예: `STEM_IDX_TO_NAME[0] === 'GAP'`
 */
export const STEM_IDX_TO_NAME: Record<StemIdx, StemName> = {
  0: 'GAP', 1: 'EUL', 2: 'BYEONG', 3: 'JEONG', 4: 'MU',
  5: 'GI', 6: 'GYEONG', 7: 'SIN', 8: 'IM', 9: 'GYE',
} as const;

// ─────────────────────────────────────────────────────────────────────────────
// 천간 이론 데이터 인터페이스
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 천간 이론 데이터 구조.
 *
 * 자평진전·적천수 등 고전 명리학 이론을 기반으로
 * 각 천간의 오행·음양·성질·형상·건강 배속 및 십성(十星) 인덱스를 담는다.
 */
export interface CheonganData {
  /** 천간 인덱스 (0~9) */
  idx: StemIdx;

  /** 천간 로마자 식별자 */
  name: StemName;

  /** 한자 표기 — 예: '甲' */
  hanja: string;

  /** 한글 표기 — 예: '갑' */
  hangul: string;

  /**
   * 오행 로마자 — MOK(木) / HWA(火) / TO(土) / GEUM(金) / SU(水)
   *
   * core/cycle.ts 의 Element('WOOD'|'FIRE'|'EARTH'|'METAL'|'WATER')와
   * 구별되는 사주 이론용 한국식 표기이다.
   */
  ohhaeng: 'MOK' | 'HWA' | 'TO' | 'GEUM' | 'SU';

  /**
   * 음양 — YANG(陽) / YIN(陰)
   *
   * 갑·병·무·경·임은 양(陽), 을·정·기·신·계는 음(陰).
   */
  eumyang: 'YANG' | 'YIN';

  /**
   * 계절 배속.
   * 목→봄, 화→여름, 금→가을, 수→겨울, 토→환절기(각 계절 말미 18일)
   */
  season: string;

  /** 방위 — 동(木) / 남(火) / 중앙(土) / 서(金) / 북(水) */
  direction: string;

  /**
   * 성질 및 특성.
   * 자평진전·적천수 원문 해설을 바탕으로 정리한 대표 성정(性情).
   */
  nature: string;

  /**
   * 형상 비유.
   * 적천수·연해자평의 물상론(物象論) 기반 대표 이미지.
   */
  image: string;

  /**
   * 건강 배속.
   * 오행 장부론(臟腑論) — 각 천간이 주관하는 신체 기관.
   */
  bodyPart: string;

  /** 강점 키워드 목록 */
  strengths: string[];

  /** 弱점 또는 주의 키워드 목록 */
  weaknesses: string[];

  /**
   * 재성(財星) 천간 인덱스 배열.
   * 일간이 극(剋)하는 오행(편재+정재). 같은 오행 양음 모두 포함.
   */
  jaeIdx: StemIdx[];

  /**
   * 관성(官星) 천간 인덱스 배열.
   * 일간을 극(剋)하는 오행(편관+정관). 같은 오행 양음 모두 포함.
   */
  gwanIdx: StemIdx[];

  /**
   * 인성(印星) 천간 인덱스 배열.
   * 일간을 생(生)하는 오행(편인+정인). 같은 오행 양음 모두 포함.
   */
  inIdx: StemIdx[];

  /**
   * 식상(食傷) 천간 인덱스 배열.
   * 일간이 생(生)하는 오행(식신+상관). 같은 오행 양음 모두 포함.
   */
  sikIdx: StemIdx[];

  /**
   * 비겁(比劫) 천간 인덱스 배열.
   * 일간과 같은 오행(비견+겁재).
   */
  biIdx: StemIdx[];
}

// ─────────────────────────────────────────────────────────────────────────────
// 십천간 이론 데이터 테이블
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 십천간(十天干) 이론 데이터 테이블.
 *
 * 인덱스 0(甲)부터 9(癸)까지 갑→계 순서로 정렬된다.
 *
 * 십성(십신) 인덱스 산출 원리:
 *   - 재성: 일간이 오행 극(剋)하는 천간 (木剋土 → 甲乙의 재성은 戊己)
 *   - 관성: 일간을 오행 극하는 천간 (金剋木 → 甲乙의 관성은 庚辛)
 *   - 인성: 일간을 오행 생(生)하는 천간 (水生木 → 甲乙의 인성은 壬癸)
 *   - 식상: 일간이 오행 생하는 천간 (木生火 → 甲乙의 식상은 丙丁)
 *   - 비겁: 일간과 동일 오행 천간 (同木 → 甲乙의 비겁은 甲乙)
 */
export const CHEONGAN_TABLE: CheonganData[] = [
  // ──────────────────────────────────────────────────────────────
  // 0. 甲 (GAP) — 양목(陽木)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 0,
    name: 'GAP',
    hanja: '甲',
    hangul: '갑',
    ohhaeng: 'MOK',
    eumyang: 'YANG',
    season: '봄(초봄)',
    direction: '동(東)',
    /**
     * 자평진전: "甲木參天, 脫胎要火." (갑목은 하늘을 찌르니 태어남에 화(火)가 필요하다.)
     * 적천수: 갑목은 대림(大林)의 목(木)으로 강직하고 위로 뻗는 성질.
     * 성질: 리더십이 강하고 직선적이며 인자(仁慈)함. 굽히지 않는 강직함.
     */
    nature: '강직하고 진취적이며 인자함. 리더십이 강하고 직선적. 굽히지 않는 의지력으로 목표를 향해 나아감. 때로 고집스럽고 융통성이 부족할 수 있음.',
    /**
     * 물상론: 울창한 숲의 큰 나무, 고목(古木), 대림(大林).
     */
    image: '울창한 숲의 큰 나무(大林·古木). 하늘을 향해 곧게 뻗은 거목.',
    /**
     * 오행 장부론: 목(木)은 간담(肝膽)을 주관. 甲은 간(肝)에 배속.
     */
    bodyPart: '간(肝), 눈(目), 근육(筋)',
    strengths: ['강한 리더십', '진취적 추진력', '인자함', '의지력', '원칙주의', '창의적 개척정신'],
    weaknesses: ['고집·완고함', '융통성 부족', '독단적 결정', '좌절 시 무기력', '남의 말을 잘 듣지 않음'],
    // 재성(財星): 甲木이 극(剋)하는 土 → 戊(4)·己(5)
    jaeIdx: [4, 5],   // 戊(편재), 己(정재)
    // 관성(官星): 甲木을 극하는 金 → 庚(6)·辛(7)
    gwanIdx: [6, 7],  // 庚(편관), 辛(정관)
    // 인성(印星): 甲木을 생하는 水 → 壬(8)·癸(9)
    inIdx: [8, 9],    // 壬(편인), 癸(정인)
    // 식상(食傷): 甲木이 생하는 火 → 丙(2)·丁(3)
    sikIdx: [2, 3],   // 丙(식신), 丁(상관)
    // 비겁(比劫): 甲木과 동일 木 → 甲(0)·乙(1)
    biIdx: [0, 1],    // 甲(비견), 乙(겁재)
  },

  // ──────────────────────────────────────────────────────────────
  // 1. 乙 (EUL) — 음목(陰木)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 1,
    name: 'EUL',
    hanja: '乙',
    hangul: '을',
    ohhaeng: 'MOK',
    eumyang: 'YIN',
    season: '봄(늦봄)',
    direction: '동(東)',
    /**
     * 자평진전: "乙木雖柔, 刲羊解牛." (을목은 비록 유하나 양과 소를 가를 수 있다.)
     * 적천수: 을목은 화초·넝쿨목으로 유연하고 환경 적응력이 뛰어남.
     * 성질: 외유내강(外柔內剛). 겉은 부드럽지만 내면의 의지는 강함. 외교적이고 협조적.
     */
    nature: '외유내강(外柔內剛). 유연하고 적응력이 뛰어나며 외교적. 환경에 따라 방향을 바꾸는 생존 능력. 의존적 성향도 있어 강한 지지 기반을 필요로 함.',
    /**
     * 물상론: 화초·넝쿨·담쟁이덩굴. 담장을 타고 오르는 덩굴처럼 유연하게 뻗음.
     */
    image: '화초·넝쿨(蔓草). 유연하게 뻗어나가는 덩굴식물.',
    /**
     * 오행 장부론: 목(木)은 간담(肝膽)을 주관. 乙은 담(膽)에 배속.
     */
    bodyPart: '담(膽), 신경계, 손발(四肢)',
    strengths: ['유연한 적응력', '외교적 사교성', '세심한 배려', '끈질긴 생명력', '협상 능력', '예술적 감각'],
    weaknesses: ['우유부단함', '의존적 성향', '환경에 흔들림', '결단력 부족', '자존감 기복'],
    // 재성: 乙木이 극하는 土 → 戊(4)·己(5)
    jaeIdx: [4, 5],   // 戊(정재), 己(편재)
    // 관성: 乙木을 극하는 金 → 庚(6)·辛(7)
    gwanIdx: [6, 7],  // 庚(정관), 辛(편관)
    // 인성: 乙木을 생하는 水 → 壬(8)·癸(9)
    inIdx: [8, 9],    // 壬(정인), 癸(편인)
    // 식상: 乙木이 생하는 火 → 丙(2)·丁(3)
    sikIdx: [2, 3],   // 丙(상관), 丁(식신)
    // 비겁: 乙木과 동일 木 → 甲(0)·乙(1)
    biIdx: [0, 1],    // 甲(겁재), 乙(비견)
  },

  // ──────────────────────────────────────────────────────────────
  // 2. 丙 (BYEONG) — 양화(陽火)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 2,
    name: 'BYEONG',
    hanja: '丙',
    hangul: '병',
    ohhaeng: 'HWA',
    eumyang: 'YANG',
    season: '여름(초여름)',
    direction: '남(南)',
    /**
     * 자평진전: "丙火猛烈, 欺霜侮雪." (병화는 맹렬하여 서리와 눈을 업신여긴다.)
     * 적천수: 병화는 태양(太陽)으로 만물을 밝히는 큰 빛. 넓게 비추되 차별 없음.
     * 성질: 명랑하고 활발하며 열정적. 드러내기를 좋아하고 과시욕이 있음.
     *        모든 것을 밝혀 드러내는 태양처럼 비밀이 없고 솔직함.
     */
    nature: '명랑하고 열정적이며 활발함. 태양처럼 밝고 에너지가 넘침. 과시욕과 표현 욕구가 강함. 솔직하고 직설적이나 때로 경솔하게 보일 수 있음.',
    /**
     * 물상론: 태양(太陽). 하늘에서 만물을 비추는 강렬한 빛.
     */
    image: '태양(太陽). 하늘 높이 떠서 온 세상을 고루 밝히는 빛.',
    /**
     * 오행 장부론: 화(火)는 심소장(心小腸)을 주관. 丙은 심장(心)에 배속.
     */
    bodyPart: '심장(心), 눈(目), 혈관(血管)',
    strengths: ['밝은 에너지', '열정과 행동력', '솔직함', '표현력', '리더십', '사교성'],
    weaknesses: ['과시욕', '경솔함', '감정 기복', '지속력 부족', '타인의 시선 의식'],
    // 재성: 丙火가 극하는 金 → 庚(6)·辛(7)
    jaeIdx: [6, 7],   // 庚(편재), 辛(정재)
    // 관성: 丙火를 극하는 水 → 壬(8)·癸(9)
    gwanIdx: [8, 9],  // 壬(편관), 癸(정관)
    // 인성: 丙火를 생하는 木 → 甲(0)·乙(1)
    inIdx: [0, 1],    // 甲(편인), 乙(정인)
    // 식상: 丙火가 생하는 土 → 戊(4)·己(5)
    sikIdx: [4, 5],   // 戊(식신), 己(상관)
    // 비겁: 丙火와 동일 火 → 丙(2)·丁(3)
    biIdx: [2, 3],    // 丙(비견), 丁(겁재)
  },

  // ──────────────────────────────────────────────────────────────
  // 3. 丁 (JEONG) — 음화(陰火)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 3,
    name: 'JEONG',
    hanja: '丁',
    hangul: '정',
    ohhaeng: 'HWA',
    eumyang: 'YIN',
    season: '여름(늦여름)',
    direction: '남(南)',
    /**
     * 자평진전: "丁火柔中, 內性昭融." (정화는 부드러운 가운데 내면의 성질이 밝고 융합한다.)
     * 적천수: 정화는 등불·촛불. 빛은 작지만 어둠을 밝히며 세밀하고 정밀함.
     * 성질: 섬세하고 예민하며 학구적. 탐구심이 강하고 지혜롭고 통찰력이 있음.
     *        겉으로 부드럽지만 내면에 뜨거운 열정과 신념을 품고 있음.
     */
    nature: '섬세하고 예민하며 학구적. 촛불처럼 내면의 빛으로 주변을 밝힘. 탐구심과 통찰력이 강하며 예술적 감수성이 풍부. 감정이 섬세하여 상처받기 쉬움.',
    /**
     * 물상론: 등불·촛불(燈燭). 어둠 속에서 정밀하게 타오르는 인공의 불빛.
     */
    image: '등불·촛불(燈燭). 밤을 밝히는 작지만 꺼지지 않는 불꽃.',
    /**
     * 오행 장부론: 화(火)는 심소장(心小腸)을 주관. 丁은 소장(小腸)에 배속.
     */
    bodyPart: '소장(小腸), 혀(舌), 신경(神經)',
    strengths: ['섬세한 관찰력', '학구적 탐구심', '예술적 감수성', '통찰력', '집중력', '내면의 열정'],
    weaknesses: ['예민함·신경질', '자기 비판 과도', '감정 상처 잘 받음', '우유부단', '고집스러운 내면'],
    // 재성: 丁火가 극하는 金 → 庚(6)·辛(7)
    jaeIdx: [6, 7],   // 庚(정재), 辛(편재)
    // 관성: 丁火를 극하는 水 → 壬(8)·癸(9)
    gwanIdx: [8, 9],  // 壬(정관), 癸(편관)
    // 인성: 丁火를 생하는 木 → 甲(0)·乙(1)
    inIdx: [0, 1],    // 甲(정인), 乙(편인)
    // 식상: 丁火가 생하는 土 → 戊(4)·己(5)
    sikIdx: [4, 5],   // 戊(상관), 己(식신)
    // 비겁: 丁火와 동일 火 → 丙(2)·丁(3)
    biIdx: [2, 3],    // 丙(겁재), 丁(비견)
  },

  // ──────────────────────────────────────────────────────────────
  // 4. 戊 (MU) — 양토(陽土)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 4,
    name: 'MU',
    hanja: '戊',
    hangul: '무',
    ohhaeng: 'TO',
    eumyang: 'YANG',
    season: '환절기(각 계절 말 18일, 특히 늦여름)',
    direction: '중앙(中央)',
    /**
     * 자평진전: "戊土固重, 旣中且正." (무토는 굳고 무거우니 중정(中正)하다.)
     * 적천수: 무토는 큰 산·대지(大地). 중후하고 넓게 포용하며 만물을 키움.
     * 성질: 신뢰감이 강하고 중후하며 신중함. 포용력과 인내심이 뛰어남.
     *        변화를 싫어하고 보수적이나 한번 마음 먹으면 흔들리지 않음.
     */
    nature: '중후하고 신중하며 신뢰감이 높음. 산처럼 굳건하고 대지처럼 포용력이 넓음. 안정 지향적이고 보수적. 한 번 결심하면 끝까지 밀고 나가는 뚝심이 있음.',
    /**
     * 물상론: 큰 산·언덕(大山·丘陵). 높고 굳건하게 자리를 지키는 대지.
     */
    image: '큰 산·언덕(大山·丘陵). 굳건하게 서서 만물을 품는 대지.',
    /**
     * 오행 장부론: 토(土)는 비위(脾胃)를 주관. 戊는 위(胃)에 배속.
     */
    bodyPart: '위(胃), 등(背), 피부(皮膚)',
    strengths: ['강한 신뢰성', '포용력', '인내와 뚝심', '안정감 제공', '책임감', '현실적 판단력'],
    weaknesses: ['변화 거부', '고집스러움', '느린 행동', '융통성 부족', '답답하게 느껴질 수 있음'],
    // 재성: 戊土가 극하는 水 → 壬(8)·癸(9)
    jaeIdx: [8, 9],   // 壬(편재), 癸(정재)
    // 관성: 戊土를 극하는 木 → 甲(0)·乙(1)
    gwanIdx: [0, 1],  // 甲(편관), 乙(정관)
    // 인성: 戊土를 생하는 火 → 丙(2)·丁(3)
    inIdx: [2, 3],    // 丙(편인), 丁(정인)
    // 식상: 戊土가 생하는 金 → 庚(6)·辛(7)
    sikIdx: [6, 7],   // 庚(식신), 辛(상관)
    // 비겁: 戊土와 동일 土 → 戊(4)·己(5)
    biIdx: [4, 5],    // 戊(비견), 己(겁재)
  },

  // ──────────────────────────────────────────────────────────────
  // 5. 己 (GI) — 음토(陰土)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 5,
    name: 'GI',
    hanja: '己',
    hangul: '기',
    ohhaeng: 'TO',
    eumyang: 'YIN',
    season: '환절기(각 계절 말 18일)',
    direction: '중앙(中央)',
    /**
     * 자평진전: "己土卑溼, 中正蓄藏." (기토는 낮고 습하니 중정하게 저축하고 간직한다.)
     * 적천수: 기토는 논밭·정원·습지. 만물을 품고 기르는 부드러운 토양.
     * 성질: 온순하고 섬세하며 포용적. 남을 돌보고 기르는 본능이 강함.
     *        실리적이고 타협적이나 의존적 성향도 있음.
     */
    nature: '온순하고 섬세하며 포용적. 논밭처럼 만물을 품어 기르는 자애로움. 실리적이고 타협적이며 협조적. 의존 성향이 있어 든든한 주변 환경이 필요.',
    /**
     * 물상론: 논밭·정원·저습지(田畓·庭園). 씨앗을 품어 키우는 비옥한 흙.
     */
    image: '논밭·정원(田畓·庭園). 씨앗을 품어 싹을 틔우는 비옥한 토양.',
    /**
     * 오행 장부론: 토(土)는 비위(脾胃)를 주관. 己는 비장(脾)에 배속.
     */
    bodyPart: '비장(脾), 복부(腹部), 소화기관',
    strengths: ['온화한 포용력', '세심한 배려', '협조적 성격', '실용적 판단', '인내력', '양육 본능'],
    weaknesses: ['의존적 성향', '우유부단함', '자기주장 약함', '걱정 과다', '경계 설정 어려움'],
    // 재성: 己土가 극하는 水 → 壬(8)·癸(9)
    jaeIdx: [8, 9],   // 壬(정재), 癸(편재)
    // 관성: 己土를 극하는 木 → 甲(0)·乙(1)
    gwanIdx: [0, 1],  // 甲(정관), 乙(편관)
    // 인성: 己土를 생하는 火 → 丙(2)·丁(3)
    inIdx: [2, 3],    // 丙(정인), 丁(편인)
    // 식상: 己土가 생하는 金 → 庚(6)·辛(7)
    sikIdx: [6, 7],   // 庚(상관), 辛(식신)
    // 비겁: 己土와 동일 土 → 戊(4)·己(5)
    biIdx: [4, 5],    // 戊(겁재), 己(비견)
  },

  // ──────────────────────────────────────────────────────────────
  // 6. 庚 (GYEONG) — 양금(陽金)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 6,
    name: 'GYEONG',
    hanja: '庚',
    hangul: '경',
    ohhaeng: 'GEUM',
    eumyang: 'YANG',
    season: '가을(초가을)',
    direction: '서(西)',
    /**
     * 자평진전: "庚金帶煞, 剛健爲最." (경금은 살기(煞氣)를 띠니 강건함이 으뜸이다.)
     * 적천수: 경금은 바위·원석(原石)·쇠. 단련되어야 쓸모가 있는 강한 원자재.
     * 성질: 강직하고 결단력이 있으며 의협심이 강함. 정의감이 뚜렷하고 불의를 참지 못함.
     *        거칠고 투박하지만 단련되면 날카롭고 유용한 도구가 됨.
     */
    nature: '강직하고 결단력이 있으며 의협심이 강함. 정의감이 뚜렷하고 불의에 맞서는 용기. 투박하고 직선적. 단련과 수련을 통해 진가를 발휘함.',
    /**
     * 물상론: 쇠·바위·원석(金石·岩石). 거칠지만 단련하면 날카로운 칼이 될 원자재.
     */
    image: '쇠·바위(金石·岩石). 용광로에서 단련되길 기다리는 강철 원석.',
    /**
     * 오행 장부론: 금(金)은 폐대장(肺大腸)을 주관. 庚은 폐(肺)에 배속.
     */
    bodyPart: '폐(肺), 뼈대(骨格), 대장(大腸)',
    strengths: ['강직한 결단력', '의협심', '실행력', '정의감', '강한 추진력', '솔직함'],
    weaknesses: ['고집·완고함', '거친 언행', '충동적 결정', '타인 감정 무시', '자기 방식 고집'],
    // 재성: 庚金이 극하는 木 → 甲(0)·乙(1)
    jaeIdx: [0, 1],   // 甲(편재), 乙(정재)
    // 관성: 庚金을 극하는 火 → 丙(2)·丁(3)
    gwanIdx: [2, 3],  // 丙(편관), 丁(정관)
    // 인성: 庚金을 생하는 土 → 戊(4)·己(5)
    inIdx: [4, 5],    // 戊(편인), 己(정인)
    // 식상: 庚金이 생하는 水 → 壬(8)·癸(9)
    sikIdx: [8, 9],   // 壬(식신), 癸(상관)
    // 비겁: 庚金과 동일 金 → 庚(6)·辛(7)
    biIdx: [6, 7],    // 庚(비견), 辛(겁재)
  },

  // ──────────────────────────────────────────────────────────────
  // 7. 辛 (SIN) — 음금(陰金)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 7,
    name: 'SIN',
    hanja: '辛',
    hangul: '신',
    ohhaeng: 'GEUM',
    eumyang: 'YIN',
    season: '가을(늦가을)',
    direction: '서(西)',
    /**
     * 자평진전: "辛金軟弱, 溫潤而淸." (신금은 부드럽고 약하나 온윤하고 맑다.)
     * 적천수: 신금은 보석·예리한 칼날. 아름답게 다듬어진 금속.
     * 성질: 예리하고 완벽주의적이며 세련됨. 심미안이 뛰어나고 날카로운 판단력.
     *        자존심이 강하고 타협하기 싫어함. 완성된 아름다움을 추구함.
     */
    nature: '예리하고 완벽주의적이며 세련됨. 보석처럼 아름다움을 추구하고 심미안이 뛰어남. 날카로운 판단력과 강한 자존심. 비판에 민감하고 타협보다 원칙을 중시.',
    /**
     * 물상론: 보석·칼날(寶石·刀劍). 정교하게 다듬어진 날카롭고 아름다운 금속.
     */
    image: '보석·칼날(寶石·刀劍). 정교하게 연마되어 빛나는 아름다운 금속.',
    /**
     * 오행 장부론: 금(金)은 폐대장(肺大腸)을 주관. 辛은 대장(大腸)에 배속.
     */
    bodyPart: '대장(大腸), 치아(齒), 피부(皮膚)',
    strengths: ['예리한 판단력', '완벽주의', '세련된 미감', '비판적 사고', '고결한 자존심', '섬세함'],
    weaknesses: ['예민함', '완벽주의로 인한 스트레스', '비판 과다', '자존심 상처 취약', '냉정함'],
    // 재성: 辛金이 극하는 木 → 甲(0)·乙(1)
    jaeIdx: [0, 1],   // 甲(정재), 乙(편재)
    // 관성: 辛金을 극하는 火 → 丙(2)·丁(3)
    gwanIdx: [2, 3],  // 丙(정관), 丁(편관)
    // 인성: 辛金을 생하는 土 → 戊(4)·己(5)
    inIdx: [4, 5],    // 戊(정인), 己(편인)
    // 식상: 辛金이 생하는 水 → 壬(8)·癸(9)
    sikIdx: [8, 9],   // 壬(상관), 癸(식신)
    // 비겁: 辛金과 동일 金 → 庚(6)·辛(7)
    biIdx: [6, 7],    // 庚(겁재), 辛(비견)
  },

  // ──────────────────────────────────────────────────────────────
  // 8. 壬 (IM) — 양수(陽水)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 8,
    name: 'IM',
    hanja: '壬',
    hangul: '임',
    ohhaeng: 'SU',
    eumyang: 'YANG',
    season: '겨울(초겨울)',
    direction: '북(北)',
    /**
     * 자평진전: "壬水通河, 能洩金氣." (임수는 강하를 통하니 능히 금기를 설기한다.)
     * 적천수: 임수는 큰 강·바다. 막힘없이 흐르며 모든 것을 포용하고 씻어냄.
     * 성질: 지혜롭고 포용력이 넓으며 유연함. 아이디어가 풍부하고 상황 파악이 빠름.
     *        자유로운 흐름을 추구하며 구속을 싫어함. 깊이 있는 사고력.
     */
    nature: '지혜롭고 포용력이 넓으며 유연함. 큰 강처럼 막힘없이 흘러 상황에 적응. 풍부한 지식과 아이디어. 자유를 추구하고 틀에 얽매이기 싫어함.',
    /**
     * 물상론: 큰 강·바다(大江·大海). 막힘없이 흘러 모든 것을 품는 광대한 물.
     */
    image: '큰 강·바다(大江·大海). 깊고 넓게 흘러 만물을 포용하는 물.',
    /**
     * 오행 장부론: 수(水)는 신방광(腎膀胱)을 주관. 壬은 신장(腎)에 배속.
     */
    bodyPart: '신장(腎), 귀(耳), 생식기(生殖器)',
    strengths: ['풍부한 지혜', '광대한 포용력', '유연한 적응력', '아이디어 창출', '상황 파악력', '자유로운 사고'],
    weaknesses: ['방향성 부족', '우유부단', '집중력 산만', '비밀스러움', '불안정한 감정'],
    // 재성: 壬水가 극하는 火 → 丙(2)·丁(3)
    jaeIdx: [2, 3],   // 丙(편재), 丁(정재)
    // 관성: 壬水를 극하는 土 → 戊(4)·己(5)
    gwanIdx: [4, 5],  // 戊(편관), 己(정관)
    // 인성: 壬水를 생하는 金 → 庚(6)·辛(7)
    inIdx: [6, 7],    // 庚(편인), 辛(정인)
    // 식상: 壬水가 생하는 木 → 甲(0)·乙(1)
    sikIdx: [0, 1],   // 甲(식신), 乙(상관)
    // 비겁: 壬水와 동일 水 → 壬(8)·癸(9)
    biIdx: [8, 9],    // 壬(비견), 癸(겁재)
  },

  // ──────────────────────────────────────────────────────────────
  // 9. 癸 (GYE) — 음수(陰水)
  // ──────────────────────────────────────────────────────────────
  {
    idx: 9,
    name: 'GYE',
    hanja: '癸',
    hangul: '계',
    ohhaeng: 'SU',
    eumyang: 'YIN',
    season: '겨울(늦겨울)',
    direction: '북(北)',
    /**
     * 자평진전: "癸水至弱, 達於天津." (계수는 지극히 약하나 천진(天津)에 통달한다.)
     * 적천수: 계수는 이슬·빗물·샘물. 작지만 만물을 적시고 생명을 유지시킴.
     * 성질: 섬세하고 내성적이며 감수성이 풍부. 예술·철학·영성에 재능이 있음.
     *        직관력과 감지력이 뛰어나나 내향적이고 고독을 즐기는 경향.
     */
    nature: '섬세하고 내성적이며 감수성이 매우 풍부함. 이슬처럼 조용히 만물을 적시는 존재. 직관력과 예지력이 뛰어남. 예술·명상·철학에 깊은 관심. 고독을 즐기며 내면 세계가 깊음.',
    /**
     * 물상론: 이슬·빗물·샘물(露水·雨水·泉水). 가늘게 스며들어 만물을 살리는 생명수.
     */
    image: '이슬·빗물(露水·雨水). 조용히 내려 대지를 적시고 만물을 살리는 생명의 물.',
    /**
     * 오행 장부론: 수(水)는 신방광(腎膀胱)을 주관. 癸는 방광(膀胱)에 배속.
     */
    bodyPart: '방광(膀胱), 자궁(子宮), 혈액(血液)',
    strengths: ['풍부한 감수성', '직관력·예지력', '예술적 재능', '내면의 깊이', '철학적 사고', '공감 능력'],
    weaknesses: ['지나친 내성적 성향', '우울 경향', '결단력 부족', '자기 표현 어려움', '비현실적 경향'],
    // 재성: 癸水가 극하는 火 → 丙(2)·丁(3)
    jaeIdx: [2, 3],   // 丙(정재), 丁(편재)
    // 관성: 癸水를 극하는 土 → 戊(4)·己(5)
    gwanIdx: [4, 5],  // 戊(정관), 己(편관)
    // 인성: 癸水를 생하는 金 → 庚(6)·辛(7)
    inIdx: [6, 7],    // 庚(정인), 辛(편인)
    // 식상: 癸水가 생하는 木 → 甲(0)·乙(1)
    sikIdx: [0, 1],   // 甲(상관), 乙(식신)
    // 비겁: 癸水와 동일 水 → 壬(8)·癸(9)
    biIdx: [8, 9],    // 壬(겁재), 癸(비견)
  },
];

// ─────────────────────────────────────────────────────────────────────────────
// 조회 함수
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 천간 이름(StemName)으로 이론 데이터를 조회한다.
 *
 * @param name - 천간 로마자 식별자 (예: 'GAP', 'EUL' …)
 * @returns 해당 천간의 `CheonganData`
 * @throws {RangeError} 유효하지 않은 이름을 전달한 경우
 *
 * @example
 * ```ts
 * const gap = getCheonganByName('GAP');
 * console.log(gap.hanja);   // '甲'
 * console.log(gap.ohhaeng); // 'MOK'
 * ```
 */
export function getCheonganByName(name: StemName): CheonganData {
  const idx = STEM_NAME_TO_IDX[name];
  const data = CHEONGAN_TABLE[idx];
  if (data === undefined) {
    throw new RangeError(`getCheonganByName: 알 수 없는 천간 이름 '${name}'`);
  }
  return data;
}

/**
 * 천간 인덱스(StemIdx, 0~9)로 이론 데이터를 조회한다.
 *
 * @param idx - 천간 인덱스 (0=甲 ~ 9=癸)
 * @returns 해당 천간의 `CheonganData`
 * @throws {RangeError} 0~9 범위를 벗어난 인덱스를 전달한 경우
 *
 * @example
 * ```ts
 * const im = getCheonganByIdx(8);
 * console.log(im.hanja);   // '壬'
 * console.log(im.eumyang); // 'YANG'
 * ```
 */
export function getCheonganByIdx(idx: StemIdx): CheonganData {
  const data = CHEONGAN_TABLE[idx];
  if (data === undefined) {
    throw new RangeError(`getCheonganByIdx: 유효하지 않은 천간 인덱스 ${idx} (허용 범위: 0~9)`);
  }
  return data;
}

// ─────────────────────────────────────────────────────────────────────────────
// 천간 쌍 (같은 오행 양음 쌍)
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 천간 오행 양음 쌍(陽陰 쌍) 배열.
 *
 * 같은 오행에 속하는 양간(陽干)·음간(陰干)을 묶은 쌍.
 * 순서는 MOK → HWA → TO → GEUM → SU.
 *
 * ```
 * [GAP, EUL]      // 甲乙 — 木
 * [BYEONG, JEONG] // 丙丁 — 火
 * [MU, GI]        // 戊己 — 土
 * [GYEONG, SIN]   // 庚辛 — 金
 * [IM, GYE]       // 壬癸 — 水
 * ```
 */
export const STEM_PAIRS: Array<[StemName, StemName]> = [
  ['GAP', 'EUL'],         // 甲乙 — 木(MOK)
  ['BYEONG', 'JEONG'],    // 丙丁 — 火(HWA)
  ['MU', 'GI'],           // 戊己 — 土(TO)
  ['GYEONG', 'SIN'],      // 庚辛 — 金(GEUM)
  ['IM', 'GYE'],          // 壬癸 — 水(SU)
] as const;

// ─────────────────────────────────────────────────────────────────────────────
// 천간 합화(合化) 결과 오행
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 천간합화(天干合化) 결과 오행 배열.
 *
 * 음양이 다른 다섯 쌍이 합(合)하여 변화하는 오행을 나타낸다.
 * 이 자체로는 합화 성립 여부를 판단하지 않으며,
 * 전통적인 합화 결과 오행만을 기록한다.
 *
 * | 합 | 양간 | 음간 | 화합 오행 |
 * |----|------|------|-----------|
 * | 甲己합 | 甲(GAP) | 己(GI) | 土(TO) |
 * | 乙庚합 | 庚(GYEONG) | 乙(EUL) | 金(GEUM) |
 * | 丙辛합 | 丙(BYEONG) | 辛(SIN) | 水(SU) |
 * | 丁壬합 | 壬(IM) | 丁(JEONG) | 木(MOK) |
 * | 戊癸합 | 戊(MU) | 癸(GYE) | 火(HWA) |
 *
 * 출처: 자평진전·적천수의 천간합화론(天干合化論)
 */
export const STEM_HAP_RESULT: Array<{
  /** 양간(陽干) — 합의 주도 간 */
  yang: StemName;
  /** 음간(陰干) — 합의 피동 간 */
  yin: StemName;
  /** 화합(化合) 결과 오행 로마자 */
  result: 'MOK' | 'HWA' | 'TO' | 'GEUM' | 'SU';
  /** 한자 설명 */
  desc: string;
}> = [
  {
    yang: 'GAP',
    yin: 'GI',
    result: 'TO',
    desc: '甲己합土 — 갑기합화토(甲己合化土). 중정지합(中正之合).',
  },
  {
    yang: 'GYEONG',
    yin: 'EUL',
    result: 'GEUM',
    desc: '乙庚합金 — 을경합화금(乙庚合化金). 인의지합(仁義之合).',
  },
  {
    yang: 'BYEONG',
    yin: 'SIN',
    result: 'SU',
    desc: '丙辛합水 — 병신합화수(丙辛合化水). 위제지합(威制之合).',
  },
  {
    yang: 'IM',
    yin: 'JEONG',
    result: 'MOK',
    desc: '丁壬합木 — 정임합화목(丁壬合化木). 음란지합(淫亂之合).',
  },
  {
    yang: 'MU',
    yin: 'GYE',
    result: 'HWA',
    desc: '戊癸합火 — 무계합화화(戊癸合化火). 무정지합(無情之合).',
  },
] as const;

// ─────────────────────────────────────────────────────────────────────────────
// 천간 상합(相合)·상충(相沖)·상극(相剋) 관계 테이블
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 천간 관계(合·沖·剋) 인터페이스.
 *
 * 특정 천간을 기준으로 합(合)·충(沖)·극(剋) 대상을 한눈에 파악하기 위한 구조체이다.
 */
export interface CheonganRelation {
  /** 기준 천간 인덱스 */
  stemIdx: StemIdx;
  /** 기준 천간 이름 */
  stemName: StemName;
  /** 기준 천간 한자 */
  stemHanja: string;

  /** 합(合) 상대: 인덱스 차이 5인 간 (오합 대상) */
  hapPartner: { idx: StemIdx; name: StemName; hanja: string; resultOhhaeng: string };

  /**
   * 충(沖) 상대: 동일 음양의 상극 관계 (인덱스 차이 6).
   * 戊·己는 충 상대가 없으므로 null.
   */
  chungPartner: { idx: StemIdx; name: StemName; hanja: string } | null;

  /** 내가 극(剋)하는 천간 2개 (편재·정재 = 아극 관계) */
  iGeuk: Array<{ idx: StemIdx; name: StemName; hanja: string; relation: string }>;

  /** 나를 극(剋)하는 천간 2개 (편관·정관 = 극아 관계) */
  geukMe: Array<{ idx: StemIdx; name: StemName; hanja: string; relation: string }>;
}

/**
 * 합화 결과 오행 조회 헬퍼 (오합 순서 기반).
 *
 * 인덱스 쌍별 합화 결과: 0↔5=TO, 1↔6=GEUM, 2↔7=SU, 3↔8=MOK, 4↔9=HWA
 */
const _hapResultMap: Record<number, string> = {
  0: 'TO', 5: 'TO',
  1: 'GEUM', 6: 'GEUM',
  2: 'SU', 7: 'SU',
  3: 'MOK', 8: 'MOK',
  4: 'HWA', 9: 'HWA',
};

/**
 * 십천간 상합(相合)·상충(相沖)·상극(相剋) 관계 완전 테이블.
 *
 * 인덱스 0~9(甲~癸) 순서대로 각 천간의 합·충·극 관계를 정리한다.
 *
 * 관계 산출 원리:
 * - 합(合): (idx + 5) % 10
 * - 충(沖): (idx + 6) % 10 (단, 戊·己 제외)
 * - 아극(我剋): 내가 극하는 오행의 양간·음간 (재성)
 * - 극아(剋我): 나를 극하는 오행의 양간·음간 (관성)
 */
export const CHEONGAN_RELATIONS: CheonganRelation[] = (() => {
  const names: readonly StemName[] = STEM_NAMES;
  const hanjas = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];

  // 오행 극 관계: 내가 극하는 오행의 인덱스 쌍
  // 木(0,1)극土(4,5), 火(2,3)극金(6,7), 土(4,5)극水(8,9), 金(6,7)극木(0,1), 水(8,9)극火(2,3)
  const iGeukMap: Record<number, [number, number]> = {
    0: [4, 5], 1: [4, 5],  // 木극土
    2: [6, 7], 3: [6, 7],  // 火극金
    4: [8, 9], 5: [8, 9],  // 土극水
    6: [0, 1], 7: [0, 1],  // 金극木
    8: [2, 3], 9: [2, 3],  // 水극火
  };

  // 나를 극하는 오행의 인덱스 쌍
  const geukMeMap: Record<number, [number, number]> = {
    0: [6, 7], 1: [6, 7],  // 木은 金에 극됨
    2: [8, 9], 3: [8, 9],  // 火는 水에 극됨
    4: [0, 1], 5: [0, 1],  // 土는 木에 극됨
    6: [2, 3], 7: [2, 3],  // 金은 火에 극됨
    8: [4, 5], 9: [4, 5],  // 水는 土에 극됨
  };

  function sipsinLabel(me: number, target: number): string {
    const sameYinyang = me % 2 === target % 2;
    // 동음양 = 편, 이음양 = 정
    return sameYinyang ? '편' : '정';
  }

  return Array.from({ length: 10 }, (_, i) => {
    const hapIdx = (i + 5) % 10;
    const chungIdx = (i + 6) % 10;
    const hasChung = i !== 4 && i !== 5; // 戊·己는 충 없음

    const iGeukPair = iGeukMap[i]!;
    const geukMePair = geukMeMap[i]!;

    return {
      stemIdx:    i as StemIdx,
      stemName:   names[i]!,
      stemHanja:  hanjas[i]!,

      hapPartner: {
        idx:            hapIdx as StemIdx,
        name:           names[hapIdx]!,
        hanja:          hanjas[hapIdx]!,
        resultOhhaeng:  _hapResultMap[i]!,
      },

      chungPartner: hasChung
        ? { idx: chungIdx as StemIdx, name: names[chungIdx]!, hanja: hanjas[chungIdx]! }
        : null,

      iGeuk: iGeukPair.map((t) => ({
        idx:      t as StemIdx,
        name:     names[t]!,
        hanja:    hanjas[t]!,
        relation: `${sipsinLabel(i, t)}재(${sipsinLabel(i, t) === '편' ? '偏財' : '正財'})`,
      })),

      geukMe: geukMePair.map((t) => ({
        idx:      t as StemIdx,
        name:     names[t]!,
        hanja:    hanjas[t]!,
        relation: `${sipsinLabel(i, t)}관(${sipsinLabel(i, t) === '편' ? '偏官' : '正官'})`,
      })),
    };
  });
})();

// ─────────────────────────────────────────────────────────────────────────────
// 천간의 십이운성(十二運星) 참조 테이블
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 천간별 주요 십이운성 지지(地支) 참조 테이블.
 *
 * 각 천간이 12지지에서 어떤 운성(장생·건록·제왕·묘 등)을 갖는지를
 * 핵심 위치만 발췌하여 수록한다.
 *
 * 전체 운성은 sipiunseong.ts의 STEM_BRANCH_LIFESTAGE를 참조할 것.
 *
 * 지지 인덱스: 子=0, 丑=1, 寅=2, 卯=3, 辰=4, 巳=5, 午=6, 未=7, 申=8, 酉=9, 戌=10, 亥=11
 */
export interface StemKeyLifeStages {
  /** 천간 인덱스 */
  stemIdx: StemIdx;
  /** 천간 이름 */
  stemName: StemName;
  /** 장생지(長生地) 지지 인덱스 */
  jangSaeng: { branchIdx: number; branchHanja: string };
  /** 건록지(建祿地) 지지 인덱스 */
  geonRok: { branchIdx: number; branchHanja: string };
  /** 제왕지(帝旺地) 지지 인덱스 */
  jeWang: { branchIdx: number; branchHanja: string };
  /** 묘지(墓地) 지지 인덱스 -- 고(庫) */
  myo: { branchIdx: number; branchHanja: string };
  /** 절지(絶地) 지지 인덱스 */
  jeol: { branchIdx: number; branchHanja: string };
}

/**
 * 천간별 핵심 십이운성 지지 테이블.
 *
 * 양간(陽干): 장생지부터 순행
 * 음간(陰干): 장생지부터 역행 (자평진전 양순음역 원칙)
 *
 * | 천간 | 장생 | 건록 | 제왕 | 묘  | 절  |
 * |------|------|------|------|-----|-----|
 * | 甲   | 亥   | 寅   | 卯   | 未  | 申  |
 * | 乙   | 午   | 卯   | 寅   | 戌  | 酉  |
 * | 丙   | 寅   | 巳   | 午   | 戌  | 亥  |
 * | 丁   | 酉   | 午   | 巳   | 丑  | 子  |
 * | 戊   | 寅   | 巳   | 午   | 戌  | 亥  |
 * | 己   | 酉   | 午   | 巳   | 丑  | 子  |
 * | 庚   | 巳   | 申   | 酉   | 丑  | 寅  |
 * | 辛   | 子   | 酉   | 申   | 辰  | 卯  |
 * | 壬   | 申   | 亥   | 子   | 辰  | 巳  |
 * | 癸   | 卯   | 子   | 亥   | 未  | 午  |
 */
export const STEM_KEY_LIFESTAGES: StemKeyLifeStages[] = [
  // 甲(0): 양간, 亥(11)부터 순행
  {
    stemIdx: 0, stemName: 'GAP',
    jangSaeng: { branchIdx: 11, branchHanja: '亥' },
    geonRok:   { branchIdx: 2,  branchHanja: '寅' },
    jeWang:    { branchIdx: 3,  branchHanja: '卯' },
    myo:       { branchIdx: 7,  branchHanja: '未' },
    jeol:      { branchIdx: 8,  branchHanja: '申' },
  },
  // 乙(1): 음간, 午(6)부터 역행
  {
    stemIdx: 1, stemName: 'EUL',
    jangSaeng: { branchIdx: 6,  branchHanja: '午' },
    geonRok:   { branchIdx: 3,  branchHanja: '卯' },
    jeWang:    { branchIdx: 2,  branchHanja: '寅' },
    myo:       { branchIdx: 10, branchHanja: '戌' },
    jeol:      { branchIdx: 9,  branchHanja: '酉' },
  },
  // 丙(2): 양간, 寅(2)부터 순행
  {
    stemIdx: 2, stemName: 'BYEONG',
    jangSaeng: { branchIdx: 2,  branchHanja: '寅' },
    geonRok:   { branchIdx: 5,  branchHanja: '巳' },
    jeWang:    { branchIdx: 6,  branchHanja: '午' },
    myo:       { branchIdx: 10, branchHanja: '戌' },
    jeol:      { branchIdx: 11, branchHanja: '亥' },
  },
  // 丁(3): 음간, 酉(9)부터 역행
  {
    stemIdx: 3, stemName: 'JEONG',
    jangSaeng: { branchIdx: 9,  branchHanja: '酉' },
    geonRok:   { branchIdx: 6,  branchHanja: '午' },
    jeWang:    { branchIdx: 5,  branchHanja: '巳' },
    myo:       { branchIdx: 1,  branchHanja: '丑' },
    jeol:      { branchIdx: 0,  branchHanja: '子' },
  },
  // 戊(4): 양간, 寅(2)부터 순행 (화토동행)
  {
    stemIdx: 4, stemName: 'MU',
    jangSaeng: { branchIdx: 2,  branchHanja: '寅' },
    geonRok:   { branchIdx: 5,  branchHanja: '巳' },
    jeWang:    { branchIdx: 6,  branchHanja: '午' },
    myo:       { branchIdx: 10, branchHanja: '戌' },
    jeol:      { branchIdx: 11, branchHanja: '亥' },
  },
  // 己(5): 음간, 酉(9)부터 역행 (화토동행)
  {
    stemIdx: 5, stemName: 'GI',
    jangSaeng: { branchIdx: 9,  branchHanja: '酉' },
    geonRok:   { branchIdx: 6,  branchHanja: '午' },
    jeWang:    { branchIdx: 5,  branchHanja: '巳' },
    myo:       { branchIdx: 1,  branchHanja: '丑' },
    jeol:      { branchIdx: 0,  branchHanja: '子' },
  },
  // 庚(6): 양간, 巳(5)부터 순행
  {
    stemIdx: 6, stemName: 'GYEONG',
    jangSaeng: { branchIdx: 5,  branchHanja: '巳' },
    geonRok:   { branchIdx: 8,  branchHanja: '申' },
    jeWang:    { branchIdx: 9,  branchHanja: '酉' },
    myo:       { branchIdx: 1,  branchHanja: '丑' },
    jeol:      { branchIdx: 2,  branchHanja: '寅' },
  },
  // 辛(7): 음간, 子(0)부터 역행
  {
    stemIdx: 7, stemName: 'SIN',
    jangSaeng: { branchIdx: 0,  branchHanja: '子' },
    geonRok:   { branchIdx: 9,  branchHanja: '酉' },
    jeWang:    { branchIdx: 8,  branchHanja: '申' },
    myo:       { branchIdx: 4,  branchHanja: '辰' },
    jeol:      { branchIdx: 3,  branchHanja: '卯' },
  },
  // 壬(8): 양간, 申(8)부터 순행
  {
    stemIdx: 8, stemName: 'IM',
    jangSaeng: { branchIdx: 8,  branchHanja: '申' },
    geonRok:   { branchIdx: 11, branchHanja: '亥' },
    jeWang:    { branchIdx: 0,  branchHanja: '子' },
    myo:       { branchIdx: 4,  branchHanja: '辰' },
    jeol:      { branchIdx: 5,  branchHanja: '巳' },
  },
  // 癸(9): 음간, 卯(3)부터 역행
  {
    stemIdx: 9, stemName: 'GYE',
    jangSaeng: { branchIdx: 3,  branchHanja: '卯' },
    geonRok:   { branchIdx: 0,  branchHanja: '子' },
    jeWang:    { branchIdx: 11, branchHanja: '亥' },
    myo:       { branchIdx: 7,  branchHanja: '未' },
    jeol:      { branchIdx: 6,  branchHanja: '午' },
  },
];

// ─────────────────────────────────────────────────────────────────────────────
// 천간의 실전 해석: 일간(日干)으로서의 성격·역할
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 천간 실전 해석 인터페이스.
 *
 * 각 천간이 일간(日干)일 때의 성격 특성과,
 * 타주(年·月·時)에 위치했을 때의 역할 해석을 담는다.
 */
export interface CheonganPractical {
  /** 천간 인덱스 */
  stemIdx: StemIdx;
  /** 천간 이름 */
  stemName: StemName;

  /**
   * 일간(日干)일 때 -- 본인의 핵심 성격.
   * 적천수·자평진전 기반 실전 성격론.
   */
  asIlgan: {
    /** 핵심 성격 키워드 */
    keywords: string[];
    /** 강할 때(신강) 특성 */
    whenStrong: string;
    /** 약할 때(신약) 특성 */
    whenWeak: string;
    /** 직업·적성 */
    career: string;
    /** 인간관계 특성 */
    relationship: string;
  };

  /**
   * 타주(他柱) -- 연주·월주·시주에 위치했을 때의 해석.
   *
   * 일간 이외의 위치에 있는 천간은 일간과의 십신(十神) 관계에 따라 해석한다.
   * 여기서는 해당 천간 자체의 위치별 상징적 의미를 수록한다.
   */
  inOtherPillar: {
    /** 연간(年干)에 있을 때 */
    year: string;
    /** 월간(月干)에 있을 때 */
    month: string;
    /** 시간(時干)에 있을 때 */
    hour: string;
  };
}

/**
 * 십천간 실전 해석 테이블.
 *
 * 적천수(滴天髓)·자평진전(子平眞詮) 실전 해석론 기반.
 * 일간(日干) 중심의 성격·적성·관계 해석과, 타주 위치별 상징 의미를 담는다.
 */
export const CHEONGAN_PRACTICAL: CheonganPractical[] = [
  // ──────────────────────────────────────────────────────────────
  // 甲 (GAP) -- 양목(陽木)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 0, stemName: 'GAP',
    asIlgan: {
      keywords: ['리더십', '강직', '개척정신', '인자함', '곧음'],
      whenStrong:
        '신강한 갑목은 리더십이 강하고 독립적이며 추진력이 뛰어나다. ' +
        '자기 주장이 명확하고 원칙을 중시한다. 지나치게 강하면 독선적이고 타인을 압도한다.',
      whenWeak:
        '신약한 갑목은 의지력이 약해지고 우유부단해진다. ' +
        '다른 사람에게 의존하기 쉽고 자신감이 부족하다. 수(水, 인성)의 지원이 필요하다.',
      career:
        '관리직, 경영자, 공무원, 군인, 교육자, 건축가, 산림업. ' +
        '큰 나무처럼 조직의 기둥 역할을 하는 직업에 적합하다.',
      relationship:
        '인자하고 정의로워 사람들이 따르지만, 고집이 세어 충돌이 잦을 수 있다. ' +
        '배우자에게 헌신적이나 완고한 면이 관계에 걸림이 된다.',
    },
    inOtherPillar: {
      year:  '가문의 큰 기둥. 조상이 정직하고 원칙적이며, 어린 시절 엄격한 가정 교육을 받았다.',
      month: '사회생활에서 리더십을 발휘. 직장에서 핵심 인물이 되며 책임감이 강하다.',
      hour:  '만년에 독립적이고 자주적인 삶. 자녀가 강직하고 성실한 성격을 지닌다.',
    },
  },

  // ──────────────────────────────────────────────────────────────
  // 乙 (EUL) -- 음목(陰木)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 1, stemName: 'EUL',
    asIlgan: {
      keywords: ['유연함', '적응력', '외교술', '끈기', '세심함'],
      whenStrong:
        '신강한 을목은 유연하면서도 내면이 강하여 어떤 환경에서든 적응하고 성장한다. ' +
        '인간관계가 넓고 협상 능력이 뛰어나다. 지나치면 집요하고 뒤에서 조종하려 한다.',
      whenWeak:
        '신약한 을목은 환경에 쉽게 흔들리고 의존적 성향이 강해진다. ' +
        '자기 주장을 펼치기 어렵고 주변 눈치를 본다. 강한 지지대(인성·비겁)가 필요하다.',
      career:
        '외교관, 상담사, 교사, 디자이너, 예술가, 의류업, 원예업. ' +
        '유연한 적응력과 세심함이 요구되는 분야에 적합하다.',
      relationship:
        '배려심이 깊고 상대의 기분을 잘 맞추지만, 너무 맞추다 보면 자신을 잃기 쉽다. ' +
        '파트너의 강한 지지가 있을 때 관계가 안정된다.',
    },
    inOtherPillar: {
      year:  '가문이 유연하고 적응적. 어린 시절 변화가 많은 환경에서 자랐다.',
      month: '사회생활에서 협조적이고 외교적. 조직 내 조율 역할을 맡는다.',
      hour:  '만년에 유연하고 평화로운 삶. 자녀가 세심하고 예술적 감각이 있다.',
    },
  },

  // ──────────────────────────────────────────────────────────────
  // 丙 (BYEONG) -- 양화(陽火)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 2, stemName: 'BYEONG',
    asIlgan: {
      keywords: ['열정', '밝음', '솔직', '표현력', '활동적'],
      whenStrong:
        '신강한 병화는 에너지가 넘치고 사교적이며 리더십이 있다. ' +
        '주변을 밝히는 태양 같은 존재이나, 지나치면 자기 과시와 경솔한 행동이 문제가 된다.',
      whenWeak:
        '신약한 병화는 열정이 식고 자신감이 저하된다. ' +
        '밖으로 드러내기보다 위축되고, 표현력이 약해져 오해받기 쉽다. 목(木, 인성)의 지원이 필요하다.',
      career:
        '방송인, 정치인, 연예인, 광고업, 에너지 산업, 요식업, 패션업. ' +
        '밝고 화려한 무대에서 빛나는 직업이 적합하다.',
      relationship:
        '열정적이고 적극적으로 다가가며 분위기를 주도한다. ' +
        '다만 감정 기복이 있어 뜨겁다 차갑다 할 수 있고, 관심이 분산되기 쉽다.',
    },
    inOtherPillar: {
      year:  '가문이 활발하고 명랑. 어린 시절 활기찬 환경에서 자랐다.',
      month: '사회생활에서 주목받는 존재. 표현력과 사교성으로 인맥이 넓다.',
      hour:  '만년에 활동적이고 열정적인 삶. 자녀가 밝고 사교적이다.',
    },
  },

  // ──────────────────────────────────────────────────────────────
  // 丁 (JEONG) -- 음화(陰火)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 3, stemName: 'JEONG',
    asIlgan: {
      keywords: ['섬세함', '통찰력', '학구적', '예술성', '내면의 열정'],
      whenStrong:
        '신강한 정화는 집중력과 통찰력이 뛰어나고 학문·예술에서 큰 성과를 낸다. ' +
        '내면에 강한 신념이 있어 자기 분야에서 깊이를 추구한다. 지나치면 고집스럽고 비타협적이다.',
      whenWeak:
        '신약한 정화는 예민하고 불안정하며 외부 자극에 쉽게 동요한다. ' +
        '자기 비판이 과도해지고 우울한 경향이 강해진다. 목(木, 인성) 특히 갑목(甲木)의 지원이 중요하다.',
      career:
        '학자, 연구원, 예술가, 작가, 상담사, IT 기술자, 종교인. ' +
        '깊이 있는 탐구와 섬세한 감수성이 요구되는 분야에 적합하다.',
      relationship:
        '내면의 열정이 깊어 한 번 마음을 주면 헌신적이지만, ' +
        '감정 표현이 서툴러 오해받기 쉽고 상대에게 많은 것을 기대한다.',
    },
    inOtherPillar: {
      year:  '가문이 학문적이고 깊이 있음. 어린 시절 교육열이 높은 환경에서 자랐다.',
      month: '사회생활에서 전문성을 발휘. 연구·분석·기획 분야에서 인정받는다.',
      hour:  '만년에 학구적이고 사색적인 삶. 자녀가 예민하고 재능이 있다.',
    },
  },

  // ──────────────────────────────────────────────────────────────
  // 戊 (MU) -- 양토(陽土)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 4, stemName: 'MU',
    asIlgan: {
      keywords: ['신뢰', '포용', '안정', '중후함', '뚝심'],
      whenStrong:
        '신강한 무토는 산처럼 굳건하고 어떤 상황에서도 흔들리지 않는다. ' +
        '포용력이 넓고 신뢰가 두터워 사람들이 의지한다. 지나치면 고지식하고 변화에 둔하다.',
      whenWeak:
        '신약한 무토는 중심이 약해지고 주변 환경에 휘둘린다. ' +
        '자신감이 부족해지고 결정을 내리기 어렵다. 화(火, 인성)의 지원이 필요하다.',
      career:
        '부동산업, 건설업, 농업, 금융업, 중개업, 행정직, 법조인. ' +
        '안정적이고 신뢰가 중요한 분야에 적합하다.',
      relationship:
        '듬직하고 의리 있어 배우자에게 안정감을 준다. ' +
        '감정 표현이 서툴고 무뚝뚝해 보일 수 있으나 내면의 정은 깊다.',
    },
    inOtherPillar: {
      year:  '가문이 안정적이고 전통적. 든든한 배경을 가지고 어린 시절을 보냈다.',
      month: '사회생활에서 중심 역할. 조직의 기반을 다지는 데 기여한다.',
      hour:  '만년에 안정적이고 여유로운 삶. 자녀가 듬직하고 책임감이 있다.',
    },
  },

  // ──────────────────────────────────────────────────────────────
  // 己 (GI) -- 음토(陰土)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 5, stemName: 'GI',
    asIlgan: {
      keywords: ['온화', '배려', '실용적', '양육', '타협적'],
      whenStrong:
        '신강한 기토는 포용력이 깊고 실용적인 판단력이 뛰어나다. ' +
        '사람을 돌보고 키우는 능력이 있어 교육·양육에 적합하다. 지나치면 집착적이고 통제하려 한다.',
      whenWeak:
        '신약한 기토는 자기 주장이 약하고 의존적 성향이 강해진다. ' +
        '걱정이 과도하고 결단력이 부족하다. 화(火, 인성)의 지원이 필요하다.',
      career:
        '교육자, 간호사, 복지사, 요리사, 제조업, 유통업, 비서. ' +
        '세심한 배려와 실용적 관리가 요구되는 분야에 적합하다.',
      relationship:
        '세심하게 돌보고 상대의 필요를 잘 파악한다. ' +
        '지나치면 상대를 속박하거나 자기 희생이 과도해 불만이 쌓인다.',
    },
    inOtherPillar: {
      year:  '가문이 온화하고 가정적. 어린 시절 돌봄을 많이 받는 환경이었다.',
      month: '사회생활에서 조정자·조력자 역할. 뒤에서 묵묵히 지원한다.',
      hour:  '만년에 가정적이고 평온한 삶. 자녀가 온순하고 효심이 있다.',
    },
  },

  // ──────────────────────────────────────────────────────────────
  // 庚 (GYEONG) -- 양금(陽金)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 6, stemName: 'GYEONG',
    asIlgan: {
      keywords: ['결단력', '정의감', '강직', '실행력', '의협심'],
      whenStrong:
        '신강한 경금은 결단력이 있고 실행력이 뛰어나며 불의를 참지 못한다. ' +
        '강한 카리스마로 주변을 압도하나, 지나치면 폭력적이고 독단적이 된다.',
      whenWeak:
        '신약한 경금은 결단력이 약해지고 우유부단해진다. ' +
        '자신감이 부족하여 타인의 의견에 끌려다닌다. 토(土, 인성)의 지원이 필요하다.',
      career:
        '군인, 경찰, 외과의사, 엔지니어, 운동선수, 금속공업, 법률가. ' +
        '강한 의지와 실행력이 필요한 분야에 적합하다.',
      relationship:
        '의리가 있고 배우자를 강하게 보호하지만, 거친 언행과 지나친 간섭이 문제가 될 수 있다. ' +
        '화(火, 관성)에 의해 단련될 때 좋은 관계를 유지한다.',
    },
    inOtherPillar: {
      year:  '가문이 강직하고 무인(武人) 기질. 어린 시절 엄격한 환경에서 자랐다.',
      month: '사회생활에서 실행력과 결단력을 발휘. 위기 상황에서 강한 면모를 보인다.',
      hour:  '만년에 강직하고 원칙적인 삶. 자녀가 의지가 강하고 독립적이다.',
    },
  },

  // ──────────────────────────────────────────────────────────────
  // 辛 (SIN) -- 음금(陰金)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 7, stemName: 'SIN',
    asIlgan: {
      keywords: ['예리함', '완벽주의', '미적 감각', '자존심', '세련됨'],
      whenStrong:
        '신강한 신금은 날카로운 판단력과 세련된 미감을 갖추며 완벽을 추구한다. ' +
        '고결한 자존심이 있어 쉽게 타협하지 않는다. 지나치면 냉정하고 비판이 과도하다.',
      whenWeak:
        '신약한 신금은 예민함이 극대화되어 사소한 일에 상처받기 쉽다. ' +
        '자존심은 높으나 이를 뒷받침할 능력이 부족해 괴로워한다. 토(土, 인성)의 지원이 필요하다.',
      career:
        '보석상, 금융 분석가, 법률가, 미술가, 음악가, 감정사, IT 전문가. ' +
        '정밀함과 미적 감각이 요구되는 분야에 적합하다.',
      relationship:
        '세련되고 품위 있는 관계를 추구하나, 완벽주의적 잣대로 상대를 평가하는 경향이 있다. ' +
        '진심을 표현하는 데 서툴러 오해가 생기기 쉽다.',
    },
    inOtherPillar: {
      year:  '가문이 세련되고 품격이 있음. 어린 시절 예술적·학문적 환경에서 자랐다.',
      month: '사회생활에서 전문성과 분석력을 발휘. 정밀한 판단이 요구되는 역할을 맡는다.',
      hour:  '만년에 고결하고 깔끔한 삶. 자녀가 예민하고 재능이 뛰어나다.',
    },
  },

  // ──────────────────────────────────────────────────────────────
  // 壬 (IM) -- 양수(陽水)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 8, stemName: 'IM',
    asIlgan: {
      keywords: ['지혜', '포용', '자유', '유연', '풍부한 아이디어'],
      whenStrong:
        '신강한 임수는 넓은 포용력과 풍부한 지혜로 어떤 상황도 유연하게 헤쳐나간다. ' +
        '큰 강처럼 도도하게 흐르며 독자적 세계를 구축한다. 지나치면 방종하고 방향성이 없다.',
      whenWeak:
        '신약한 임수는 지혜가 흩어지고 집중력이 부족해진다. ' +
        '감정이 불안정하고 현실 대응 능력이 약해진다. 금(金, 인성)의 지원이 필요하다.',
      career:
        '무역업, 운송업, 학자, 철학자, 여행업, 음료·주류업, 수산업. ' +
        '넓은 시야와 유연한 사고가 요구되는 분야에 적합하다.',
      relationship:
        '포용력이 넓어 다양한 사람과 잘 어울리나, 깊은 관계를 유지하기 어렵다. ' +
        '자유를 추구하여 구속받는 관계를 싫어하고, 감정 표현이 모호할 수 있다.',
    },
    inOtherPillar: {
      year:  '가문이 넓고 교류가 활발. 어린 시절 다양한 경험을 하며 자랐다.',
      month: '사회생활에서 인맥이 넓고 아이디어가 풍부. 기획·전략 분야에서 두각을 나타낸다.',
      hour:  '만년에 자유롭고 유유자적한 삶. 자녀가 똑똑하고 독립적이다.',
    },
  },

  // ──────────────────────────────────────────────────────────────
  // 癸 (GYE) -- 음수(陰水)
  // ──────────────────────────────────────────────────────────────
  {
    stemIdx: 9, stemName: 'GYE',
    asIlgan: {
      keywords: ['감수성', '직관력', '내면의 깊이', '예술성', '영성'],
      whenStrong:
        '신강한 계수는 직관력과 예지력이 뛰어나고 내면이 깊다. ' +
        '예술·철학·영성 분야에서 독보적 재능을 발휘한다. 지나치면 비밀스럽고 음침해 보인다.',
      whenWeak:
        '신약한 계수는 감수성이 지나쳐 우울하고 불안정해진다. ' +
        '현실 적응이 어렵고 고립되기 쉽다. 금(金, 인성)의 지원이 필요하다.',
      career:
        '예술가, 철학자, 심리학자, 점술가, 의약업, 화학자, 종교인. ' +
        '깊은 내면 탐구와 직관이 요구되는 분야에 적합하다.',
      relationship:
        '깊은 감정의 교류를 원하며 진정성 있는 관계를 추구한다. ' +
        '표현이 서툴러 속마음을 드러내기 어렵고, 상대를 깊이 이해하되 자신은 이해받지 못한다고 느끼기 쉽다.',
    },
    inOtherPillar: {
      year:  '가문이 내면적이고 학문적. 어린 시절 조용하고 사색적인 환경에서 자랐다.',
      month: '사회생활에서 섬세함과 직관력을 발휘. 뒤에서 조용히 핵심을 파악하는 역할.',
      hour:  '만년에 사색적이고 영적인 삶. 자녀가 감수성이 풍부하고 창의적이다.',
    },
  },
];

// ─────────────────────────────────────────────────────────────────────────────
// 천간 상극(相剋) 관계 상수
// ─────────────────────────────────────────────────────────────────────────────

/**
 * 천간 상극(相剋) 관계 테이블.
 *
 * 오행 상극(木剋土, 火剋金, 土剋水, 金剋木, 水剋火)을 천간 인덱스로 표현한다.
 * 각 항목은 극하는 간(主)과 극당하는 간(客), 그리고 음양 동이에 따른
 * 편극(偏剋, 동음양)과 정극(正剋, 이음양) 구분을 포함한다.
 */
export const CHEONGAN_GEUK_TABLE: Array<{
  /** 극하는 천간 인덱스 (主) */
  fromIdx: StemIdx;
  /** 극당하는 천간 인덱스 (客) */
  toIdx: StemIdx;
  /** 극 명칭 -- 예: '甲剋戊' */
  name: string;
  /** 오행 극 관계 -- 예: '목극토(木剋土)' */
  ohhaengGeuk: string;
  /**
   * 음양 동이에 따른 분류:
   * - '편극': 동음양 (양vs양, 음vs음) -> 편관·편재 관계
   * - '정극': 이음양 (양vs음, 음vs양) -> 정관·정재 관계
   */
  type: '편극' | '정극';
}> = (() => {
  const hanjas = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];
  // 오행별 극 대상 인덱스: 木(0,1)->土(4,5), 火(2,3)->金(6,7), 土(4,5)->水(8,9), 金(6,7)->木(0,1), 水(8,9)->火(2,3)
  const geukPairs: [number, number][] = [
    [0, 4], [0, 5], [1, 4], [1, 5],  // 木剋土
    [2, 6], [2, 7], [3, 6], [3, 7],  // 火剋金
    [4, 8], [4, 9], [5, 8], [5, 9],  // 土剋水
    [6, 0], [6, 1], [7, 0], [7, 1],  // 金剋木
    [8, 2], [8, 3], [9, 2], [9, 3],  // 水剋火
  ];

  const ohhaengNames: Record<number, string> = {
    0: '목', 1: '목', 2: '화', 3: '화', 4: '토', 5: '토', 6: '금', 7: '금', 8: '수', 9: '수',
  };

  return geukPairs.map(([from, to]) => ({
    fromIdx:     from as StemIdx,
    toIdx:       to as StemIdx,
    name:        `${hanjas[from]}剋${hanjas[to]}`,
    ohhaengGeuk: `${ohhaengNames[from]}극${ohhaengNames[to]}(${hanjas[from]}${hanjas[to]})`,
    type:        (from % 2 === to % 2 ? '편극' : '정극') as '편극' | '정극',
  }));
})();
